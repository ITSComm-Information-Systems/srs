{% extends 'base.html' %}
{% block content %}

<form action="/reports/tolls/" method="POST" onsubmit="return validate()" name="Select">{% csrf_token %}
    <h1>Toll Statements</h1>
    <h2>Select a billing period:</h2>
    <p>Billing period 
        <select requried type="select" name="bill_period" id="month" value="{{ i }}">
            <option value="%">--Select--</option>
            {% for i in periods %}
            <option value="{{ i }}">{{ i }}</option>
            {% endfor %}
        </select>
     </p>
    {% if depts %}
        <p>Departments
            <select requried type="select" name="dept_id" id="month" value="{{ i }}" onchange="display_dept({{dept_names}})">
                <option value="%">--Select--</option>
                {% for dept in depts %}
                <option value="{{ dept }}">{{ dept }}</option>
                {% endfor %}
        </select>
     </p>
          <p id="display"></p>
     {% endif %}
    <p><input type='submit' value='Submit' class="btn btn-primary"></p>
</form>

{% if inactive %}
    <p style="color:red">{{dept_name}} ({{dept_id}})**</p>
{% else %}
    <p>{{dept_name}} ({{dept_id}})</p>
{% endif %}

<p>{{bill_period}}</p>
<table class="table table-hover table-headings">
    <thead>
        <tr>
                <th>CSV</th>
                <th>PDF</th>
                <th>Condensed PDF</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            {% comment %} have to put department on page when selection occurs  {% endcomment %}
                <td> 
                    <a href='download/csv/{{bill_month}}_{{bill_year}}/{{dept_id}}/'><img src='media/pictures/csv_icon.png'/>CSV Download</a></td>
                <td> 
                    <a href='download/pdf/{{bill_month}}_{{bill_year}}/{{dept_id}}/'><img src='settings.MEDIA_ROOT/PDF_icon.png'/>PDF Download</a></td>
                <td>
                    <a href='download/cond-pdf/{{bill_month}}_{{bill_year}}/{{dept_id}}/'><img src='settings.MEDIA_ROOT/PDF_icon.png'/>Condensed PDF Download</a></td>
        </tr>
    </tbody>
</table>

<script>
    function validate() {
        var bill_date = document.forms["Select"]["bill_period"];
        var deptid = document.forms["Select"]["dept_id"];

        if (bill_date.selectedIndex < 1) {
            window.alert("Please select a billing date.");
            bill_date.focus();
            return false;
        }
        if (deptid.selectedIndex < 1) {
            deptid.focus();
            window.alert("Please select a department.");
            return false;
        }
        return true;
    }

    function display_dept(depts) {
        var deptid = document.forms["Select"]["dept_id"];
        var index = deptid.selectedIndex - 1;
        document.getElementById("display").innerHTML = depts[index];
    }
</script>

{% endblock %}