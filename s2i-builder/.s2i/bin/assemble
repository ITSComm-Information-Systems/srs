#!/bin/bash
set -e

echo "---> S2I assemble starting"

# S2I runs as arbitrary UID; make sure HOME is set to a writable dir
export HOME=/opt/app-root
APP_DIR=$HOME/app
SRC_DIR=/tmp/src

mkdir -p $HOME/.local
mkdir -p $APP_DIR

echo "Skipping pip install â€” dependencies already included in builder image"
#pip install --user -r $SRC_DIR/requirements.txt

echo "---> Copying application source"
cp -R $SRC_DIR/* $APP_DIR/

echo "---> Running collectstatic"
python $APP_DIR/manage.py collectstatic --noinput || true

echo "---> Assemble complete"
